(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{107:function(t,e,a){"use strict";a.r(e);var s=a(442);a(443);let i={bold:!0,italic:!0,header:!0,underline:!1,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!1,table:!0,subfield:!0,fullscreen:!1,readmodel:!1,htmlcode:!1,help:!0,undo:!0,redo:!0,trash:!0,save:!1,navigation:!1,alignleft:!1,aligncenter:!1,alignright:!1};var o={data:()=>({defaultValue:"",imgUploadBaseUrl:URL.rpi,imgBaseUrl:URL.img}),props:{content:String,keys:{type:String,default:""},updated:{type:Boolean,default:!1},toolbarConfig:{type:Object,default:function(){return i}}},mounted(){Object.assign(i,this.toolbarConfig),this.defaultValue=this.content},beforeDestroy(){this.defaultValue=""},methods:{valueChange:function(t,e){this.$emit("change_text",{val:t,keys:this.keys})},imgAdd:function(t,e){this.formatDetection(t,e)},formatDetection:function(t,e){const a=["jpg","jpeg","png"];if(e.size/1024<10240){let s=e.type.split("/")[1],i=s.toUpperCase(),o=a.indexOf(s),l=a.indexOf(i);-1!=o||-1!=l?this.isMatch(e.name.split(".")[0])?this.imgSubmit(t,e):(this.$message(`${e.name}文件名格式不符合！只能是英文数字下划线`),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t),setTimeout(()=>{document.querySelector(".fa-mavon-undo").click()},500)):(this.$message(`${e.name}文件格式不符合！`),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t),setTimeout(()=>{document.querySelector(".fa-mavon-undo").click()},500))}else this.$message(`${e.name}文件大小超过限制！`),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t),setTimeout(()=>{document.querySelector(".fa-mavon-undo").click()},500)},isMatch:function(t){return/^[a-zA-Z\d_]*$/.test(t)},imgSubmit(t,e){let a=new FormData;a.append("post_type","upfile"),a.append("upfile[]",e,e.name);let s=this;this.$.autoAjax("post",this.imgUploadBaseUrl,a,"",{ok:e=>{if(e.state&&0==e.state){let a="";a=this.imgBaseUrl+e.data.file[0].url,s.$refs.mavonEditor.$img2Url(t,a),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t)}else this.$message.error(LANG["文件上传失败，请稍后重试！"]||"文件上传失败，请稍后重试！"),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t),setTimeout(()=>{document.querySelector(".fa-mavon-undo").click()},500)},p:()=>{},error:t=>{console.log(t)}}).catch(e=>{this.$message.error(LANG["服务器错误请稍后重试！"]||"服务器错误请稍后重试！"),this.$refs.mavonEditor.$refs.toolbar_left.$imgDelByFilename(t),setTimeout(()=>{document.querySelector(".fa-mavon-undo").click()},500)})}},watch:{content:function(t,e){this.$nextTick(()=>{this.defaultValue=t})}},components:{mavonEditor:s.mavonEditor}},l=a(24);var n=function(t){a(441)},d={data:()=>({LANG:LANG,modeData:{name:"",type_id:"",title:"",begin_time:"",end_time:"",issue_mode:"",day:"",money:"",get:"",getMath:"",vipType:[],daySign:"",statusWdl:"",withdrawalsBs:"",withdrawalsGd:"",status:"1",description:"",cover:"",language_id:"",language_name:"",content:"",fileList2:[],sort:"",open_mode:"",link:""},type_idList:[],vipList:[],checkedDefut:[],isIndeterminate:!0,checkList:[],seachData:{},languageList:[],uploadUrl:""}),components:{markdownEdit:Object(l.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"markdownEdit"}},[e("mavon-editor",{ref:"mavonEditor",staticClass:"mavonEditorContainer",attrs:{toolbars:this.toolbarConfig,value:this.defaultValue,toolbarsFlag:!0,default_open:"edit",subfield:!1},on:{change:this.valueChange,imgAdd:this.imgAdd}})],1)},[],!1,n,null,null).exports,upload:a(204).a},methods:{init(){if(this.$route.query){let t=this.$route.query;for(let e in t)this.seachData[e]=t[e]}this.modeData.name=this.seachData.label,this.$http.get(URL.api+ROUTES.GET.activity.types+"?page=1&page_size=100",URLCONFIG).then(t=>{if(0==t.data.state&&t.data.data){let e=t.data.data||[];for(let t in e)this.type_idList.push({label:e[t].name,value:e[t].id.toString()})}});let t=URL.api+ROUTES.GET.user.level.list;this.$http.get(t,URLCONFIG).then(t=>{let e=t.data.data;for(let t in e)this.vipList.push({label:e[t].name,value:e[t].id})}).catch(function(t){});let e=URL.api+ROUTES.GET.langeages;this.$http.get(e,URLCONFIG).then(t=>{let e=t.data.data;for(let t in e)this.languageList.push({label:e[t].name,value:e[t].id.toString()})})},handleCheckAllChange(t){let e=[];for(let t in this.vipList)e[t]=this.vipList[t].label;this.checkedDefut=t.target.checked?e:[],this.isIndeterminate=!1},handleCheckedDefutChange(t){let e=t.length;this.checkAll=e===this.vipList.length,this.isIndeterminate=e>0&&e<this.vipList.length},doSubmit(t){let e={id:"37",name:this.modeData.name,type_id:"9",title:this.modeData.title,begin_time:this.modeData.begin_time,end_time:this.modeData.end_time,description:this.modeData.description,cover:this.modeData.cover,language_id:parseInt(this.modeData.language_id),language_name:this.modeData.language_name,content:this.modeData.content,issue_mode:this.modeData.issue_mode,status:this.modeData.status,sort:this.modeData.sort,open_mode:this.modeData.open_mode,link:this.modeData.link,rule:{id:"37",template_id:"9",template_name:"充值优惠",active_id:"37",rule:{company:{first:[{money:1e5,type:1,prize:1e4},{money:2e5,type:2,prize:10,upper_limit:1e5}],again:[{money:1e5,type:1,prize:5e3},{money:2e5,type:2,prize:8,upper_limit:1e5}]},online:{first:[{money:1e5,type:1,prize:10},{money:2e5,type:2,prize:10,upper_limit:1e5}],again:[{money:1e5,type:1,prize:1e4},{money:2e5,type:2,prize:10,upper_limit:1e5}]}},luckydraw_condition:null,limit_times:null,withdraw_require:"times",withdraw_require_val:"5",member_level:null,issue_time:"0",issue_cycle:null,issue_mode:"auto",games:""}},a=URL.api+`/active/template.fix/${e.id}`;"add"==t?this.$http.put(a,e,URLCONFIG).then(t=>{}):this.$http.put(a,URLCONFIG).then(t=>{})},goBack(t){"add"==t?this.$router.push({path:"addActiveSet"}):this.$router.push({path:"activeSet"})},doSaveFile(t){this.modeData.cover=t[0]},changeLanguage(t){this.languageList}},computed:{},mounted(){},created(){this.init()},watch:{$route(t,e){if(this.$route.query){let t=this.$route.query;for(let e in t)this.seachData[e]=t[e]}this.modeData.name=this.seachData.label}}};var r=function(t){a(440)},m=Object(l.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"activeMode"}},[a("el-col",{attrs:{span:24}},[a("el-col",{staticClass:"Layout",attrs:{span:12}},[a("h3",{staticClass:"tCent",domProps:{textContent:t._s(t.LANG["规则设置"]||"规则设置")}}),t._v(" "),a("el-form",{ref:"form",staticClass:"mt20",attrs:{model:t.modeData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"优惠活动名称"}},[a("el-input",{staticClass:"w80",attrs:{disabled:"true"},model:{value:t.modeData.name,callback:function(e){t.$set(t.modeData,"name",e)},expression:"modeData.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠类型"}},[a("el-select",{staticClass:"w80",attrs:{placeholder:"请选择类型"},model:{value:t.modeData.type_id,callback:function(e){t.$set(t.modeData,"type_id",e)},expression:"modeData.type_id"}},t._l(t.type_idList,function(t,e){return a("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"有效时间"}},[a("el-col",{attrs:{span:10}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期"},model:{value:t.modeData.begin_time,callback:function(e){t.$set(t.modeData,"begin_time",e)},expression:"modeData.begin_time"}})],1),t._v(" "),a("el-col",{staticClass:"line",attrs:{span:1}},[t._v("-")]),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择结束日期"},model:{value:t.modeData.end_time,callback:function(e){t.$set(t.modeData,"end_time",e)},expression:"modeData.end_time"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"发放奖金",prop:"issue_mode"}},[a("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:t.modeData.issue_mode,callback:function(e){t.$set(t.modeData,"issue_mode",e)},expression:"modeData.issue_mode"}},[a("span",{domProps:{textContent:t._s(t.LANG["自动发放"]||"自动发放")}})]),t._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"2"},model:{value:t.modeData.issue_mode,callback:function(e){t.$set(t.modeData,"issue_mode",e)},expression:"modeData.issue_mode"}},[a("span",{domProps:{textContent:t._s(t.LANG["手动发放"]||"手动发放")}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠规则"}},[a("span",{domProps:{textContent:t._s(t.LANG["完成邮箱验证优惠金额"]||"完成邮箱验证优惠金额")}}),t._v(" "),a("el-input",{staticClass:"intW",model:{value:t.modeData.money,callback:function(e){t.$set(t.modeData,"money",e)},expression:"modeData.money"}}),t._v(" "),a("span",{domProps:{textContent:t._s(t.LANG["元"]||"元")}})],1),t._v(" "),a("el-form-item",{attrs:{label:"领取限制"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.modeData.get,callback:function(e){t.$set(t.modeData,"get",e)},expression:"modeData.get"}},[a("span",{domProps:{textContent:t._s(t.LANG["限定次数"]||"限定次数")}}),t._v(" "),a("el-input",{staticClass:"intW",model:{value:t.modeData.getMath,callback:function(e){t.$set(t.modeData,"getMath",e)},expression:"modeData.getMath"}})],1),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.modeData.get,callback:function(e){t.$set(t.modeData,"get",e)},expression:"modeData.get"}},[a("span",{domProps:{textContent:t._s(t.LANG["无限定次数"]||"无限定次数")}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"有效会员等级"}},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.modeData.vipType,callback:function(e){t.$set(t.modeData,"vipType",e)},expression:"modeData.vipType"}},[t._v("全部\n                    ")]),t._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),t._v(" "),a("el-checkbox-group",{on:{change:t.handleCheckedDefutChange},model:{value:t.checkedDefut,callback:function(e){t.checkedDefut=e},expression:"checkedDefut"}},t._l(t.vipList,function(t,e){return a("el-checkbox",{key:e,attrs:{label:t.label,name:"type"}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"发放时间"}},[a("span",{domProps:{textContent:t._s(t.LANG["完成邮箱验证后"]||"完成邮箱验证后")}}),t._v(" "),a("el-input",{staticClass:"intW",model:{value:t.modeData.daySign,callback:function(e){t.$set(t.modeData,"daySign",e)},expression:"modeData.daySign"}}),t._v(" "),a("span",{domProps:{textContent:t._s(t.LANG["天发放"]||"天发放")}})],1),t._v(" "),a("el-form-item",{attrs:{label:"提款要求"}},[a("el-radio",{attrs:{label:"1"},model:{value:t.modeData.statusWdl,callback:function(e){t.$set(t.modeData,"statusWdl",e)},expression:"modeData.statusWdl"}},[a("span",{domProps:{textContent:t._s(t.LANG["倍数"]||"倍数")}}),t._v(" "),a("el-input",{staticClass:"intW",model:{value:t.modeData.withdrawalsBs,callback:function(e){t.$set(t.modeData,"withdrawalsBs",e)},expression:"modeData.withdrawalsBs"}})],1),t._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:t.modeData.statusWdl,callback:function(e){t.$set(t.modeData,"statusWdl",e)},expression:"modeData.statusWdl"}},[a("span",{domProps:{textContent:t._s(t.LANG["投注流水"]||"投注流水")}}),t._v(" "),a("el-input",{staticClass:"intW",model:{value:t.modeData.withdrawalsGd,callback:function(e){t.$set(t.modeData,"withdrawalsGd",e)},expression:"modeData.withdrawalsGd"}})],1),t._v(" "),a("el-radio",{attrs:{label:"3"},model:{value:t.modeData.statusWdl,callback:function(e){t.$set(t.modeData,"statusWdl",e)},expression:"modeData.statusWdl"}},[a("span",{domProps:{textContent:t._s(t.LANG["无取款要求"]||"无取款要求")}})])],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio",{staticClass:"radio",attrs:{label:"1"},model:{value:t.modeData.status,callback:function(e){t.$set(t.modeData,"status",e)},expression:"modeData.status"}},[a("span",{domProps:{textContent:t._s(t.LANG["启用"]||"启用")}})]),t._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:"0"},model:{value:t.modeData.status,callback:function(e){t.$set(t.modeData,"status",e)},expression:"modeData.status"}},[a("span",{domProps:{textContent:t._s(t.LANG["停用"]||"停用")}})])],1)],1)],1),t._v(" "),a("el-col",{staticClass:"Layout",attrs:{span:12}},[a("h3",{staticClass:"tCent",domProps:{textContent:t._s(t.LANG["内容设置"]||"内容设置")}}),t._v(" "),a("el-form",{ref:"form",staticClass:"mt20",attrs:{model:t.modeData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"优惠活动标题"}},[a("el-input",{staticClass:"w80",model:{value:t.modeData.title,callback:function(e){t.$set(t.modeData,"title",e)},expression:"modeData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"语言"}},[a("el-select",{staticClass:"w80",attrs:{placeholder:"请选择类型"},on:{change:t.changeLanguage},model:{value:t.modeData.language_id,callback:function(e){t.$set(t.modeData,"language_id",e)},expression:"modeData.language_id"}},t._l(t.languageList,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠活动描述"}},[a("el-input",{staticClass:"w80",attrs:{type:"textarea"},model:{value:t.modeData.description,callback:function(e){t.$set(t.modeData,"description",e)},expression:"modeData.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"优惠活动图片"}},[a("upload",{attrs:{uploadUrl:t.uploadUrl,arrList:""},on:{response:t.doSaveFile}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.LANG["优惠规则编辑"]||"优惠规则编辑"}},[a("markdownEdit")],1)],1)],1),t._v(" "),"add"==t.seachData.type?a("el-col",{staticClass:"tCent",attrs:{span:24}},[a("el-button",{attrs:{type:"primary",plain:!0},on:{click:function(e){return t.goBack(t.type="add")}}},[a("span",{domProps:{textContent:t._s(t.LANG["取消生成"]||"取消生成")}})]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.doSubmit(t.type="add")}}},[a("span",{domProps:{textContent:t._s(t.LANG["生成优惠"]||"生成优惠")}})])],1):a("el-col",{staticClass:"tCent",attrs:{span:24}},[a("el-button",{attrs:{type:"primary",plain:!0},on:{click:function(e){return t.goBack(t.type="edit")}}},[a("span",{domProps:{textContent:t._s(t.LANG["取消修改"]||"取消修改")}})]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.doSubmit(t.type="edit")}}},[a("span",{domProps:{textContent:t._s(t.LANG["保存修改"]||"保存修改")}})])],1)],1)],1)},[],!1,r,null,null);e.default=m.exports},204:function(t,e,a){"use strict";var s={props:{keys:{type:String,default:""}},data:()=>({imgBaseUrl:sessionStorage.URL_RPI,stsToken:sessionStorage.stsToken,LANG:LANG,loading:!1,imgUrl:"",imgConfig:{file:"",key:""}}),created(){this.init()},methods:{init(){this.loading=!1,this.imgUrl="",this.imgBaseUrl=sessionStorage.URL_RPI,this.stsToken=sessionStorage.stsToken,this.imgConfig.key=this.keys},change(){let t=this,e=t.$("#file").val().split("\\"),a=new FormData(t.$("#formTag")[0]);t.loading=!0,a.append("pictrue",e[e.length-1]),a.append("pf","h5"),this.$.ajax({url:t.imgBaseUrl,type:"post",dataType:"json",cache:!1,headers:{Authorization:t.stsToken},data:a,processData:!1,contentType:!1,success:function(e){e.data&&1e4===e.code?(t.imgUrl=e.data.cache_url,t.$message.success("上传图片成功"),t.loading=!1,e.data.file_name&&(t.imgConfig.file=e.data.file_name)):(t.loading=!1,t.$message.error("资源站密钥失效，上传图片失败，请重新登录。"))},error:function(e){t.$message.error("上传图片失败"),t.loading=!1}})}},watch:{imgConfig:{handler(t,e){t&&t.file&&this.$emit("doUpload",{file:t.file,key:t.key})},immediate:!0,deep:!0}},computed:{}},i=a(24);var o=function(t){a(213)},l=Object(i.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"warp"},[a("form",{attrs:{id:"formTag",enctype:"multipart/form-data"}},[a("div",{staticClass:"uploadImgBtn",attrs:{id:"uploadImgBtn"}},[a("input",{staticClass:"uploadImg",attrs:{type:"file",name:"file",id:"file",loading:!0},on:{change:t.change}}),a("i",{staticClass:"el-icon-upload"}),t._v("选择图片\n        ")])]),t._v(" "),t.loading?a("div",{staticClass:"up-loading"},[a("i",{staticClass:"el-icon-loading"}),t._v(" 正在上传图片...")]):t._e(),t._v(" "),t.imgUrl?a("img",{staticClass:"preview",attrs:{src:t.imgUrl,alt:"图片预览"}}):t._e()])},[],!1,o,"data-v-478de2d2",null);e.a=l.exports},213:function(t,e,a){},440:function(t,e,a){},441:function(t,e,a){},442:function(t,e,a){t.exports=a(9)(818)},443:function(t,e,a){}}]);