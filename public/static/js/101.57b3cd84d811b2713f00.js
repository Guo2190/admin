(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{185:function(e,s,t){"use strict";t.r(s);var a=t(202),o=t(203),i=t(206),r={data:()=>({nowId:-1,nowName:null,LANG:LANG,columnsUrl:"",tableUrl:"",baseUrl:"",searchConfig:[{prop:"name",value:"",type:"text",label:"用户名"}],searchType:"search",searchIsEdit:{state:!1},searchFormVisible:{state:!0},formTitel:"",formVisible:{state:!1},userId:"",userName:"",updated:!1,type:"default",labelWidth:"100px",isEdit:{state:!1},formConfig:[{prop:"username",value:"",type:"text",label:"帐号",rules:[{require:!0},{min:1,max:30}]},{prop:"password",value:"",type:"password",label:"密码",rules:[{require:!0},{min:3,max:10}]},{prop:"repeatPassword",value:"",label:"确认密码",type:"repeatPassword",rules:[{require:!0},{min:6}]},{prop:"truename",value:"",type:"text",label:"姓名"},{prop:"depart",value:"",type:"text",label:"部门"},{prop:"job",value:"",type:"text",label:"职位"},{prop:"role",radio:"",type:"radioGroup",label:"选择角色权限",radioInput:!1,list:[],rules:[{require:!0}]}],passTitle:"",passVisible:{state:!1},passConfig:[{prop:"password",value:"",type:"password",label:"密码",rules:[{require:!0},{min:6}]},{prop:"repeatPassword",value:"",label:"确认密码",type:"repeatPassword",rules:[{require:!0},{min:6}]}],loading:!1,confirmConfig:{state:!1,msg:"",fn:""},updateKeys:"",formType:""}),components:{tablegrid:a.a,formEdit:o.a,confirm:i.a},methods:{init(){this.columnsUrl="/static/json/accoutManage/childAccount/columns.json",this.tableUrl=URL.api+"/sub/accounts",this.baseUrl=URL.api+"/sub/accounts";let e=this;this.$.autoAjax("get",URL.api+ROUTES.GET.sub.accounts.role,"",{ok:s=>{if(0==s.state&&s.data){let t=s.data;for(let s in t){let a={label:"",value:""};a.label=t[s].role,a.value=t[s].id,e.formConfig[6].list.push(a)}}else 40001===s.state?e.$message.error(LANG["帐号已存在，请修改后重试"]||"帐号已存在，请修改后重试"):e.$message.error(LANG["获取子帐号角色失败"]||"获取子帐号角色失败")},p:()=>{},error:e=>{console.log(e)}})},openUserSet(e){this.$router.push({path:"/memberManagement",query:{name:e.name}})},doQuery(e){let s={};e.item.name&&(s.name=e.item.name),this.tableUrl=this.baseUrl+this.addSearch(s)},resetForm(){this.tableUrl=this.baseUrl},doAdd(){let e=this;e.formConfig[6].list=[],this.$.autoAjax("get",URL.api+ROUTES.GET.sub.accounts.role,"",{ok:s=>{if(0==s.state&&s.data){let t=s.data;for(let s in t){let a={label:"",value:""};a.label=t[s].role,a.value=t[s].id,e.formConfig[6].list.push(a)}}else 40001===s.state?e.$message.error(LANG["帐号已存在，请修改后重试"]||"帐号已存在，请修改后重试"):e.$message.error(LANG["获取子帐号角色失败"]||"获取子帐号角色失败")},p:()=>{},error:e=>{console.log(e)}}),this.formConfig[0].disabled=!1,this.formConfig[1].disabled=!1,this.formConfig[2].disabled=!1,this.formTitel="新建子帐号",this.formType="add",this.formVisible.state=!0,this.updated=!1},doEdit(e){this.formConfig[0].disabled=!0,this.formConfig[1].disabled=!0,this.formConfig[2].disabled=!0;let s=-1;for(let t in this.formConfig[6].list)this.formConfig[6].list[t].label===e.role&&(s=this.formConfig[6].list[t].value.toString());this.loading=!0,this.formConfig[0].value=e.username,this.formConfig[1].value="密码在改密中修改",this.formConfig[2].value="密码在改密中修改",this.formConfig[3].value=e.truename,this.formConfig[4].value=e.part,this.formConfig[5].value=e.job,this.formConfig[6].value=s,this.formTitel="修改子帐号";let t=this;setTimeout(function(){t.formType="edit",t.formVisible.state=!0,t.loading=!1},500)},getForm(e){let s=this;this.loading=!0;let t={};for(let s in e.formObj)t[s]=e.formObj[s];if("pass"==this.formType){let e={};e["pw-new"]=t.repeatPassword,e.id=this.userId,e.sub_name=this.userName,this.$.autoAjax("patch",URL.api+"/sub/account.pw?id="+this.userId,e,{ok:e=>{null!=e.data&&e.data?(this.$message.success(LANG["恭喜您，密码修改成功！"]||"恭喜您，密码修改成功！"),s.updated=!0):this.$message.error(LANG["密码修改失败！"]||"密码修改失败！"),s.loading=!1,s.updated=!0},p:()=>{},error:e=>{console.log(e)}})}else"add"==this.formType?(delete t.repeatPassword,this.$.autoAjax("put",URL.api+ROUTES.PUT.sub.accounts,t,{ok:e=>{0===e.state&&e.data?(s.$message.success(LANG["恭喜您，子帐号添加成功！"]||"恭喜您，子帐号添加成功！"),s.updated=!0):s.$message.error(LANG[`${e.msg}`]||`${e.msg}`),s.loading=!1,s.updated=!0},p:()=>{},error:e=>{console.log(e)}})):"edit"==this.formType&&(t.username,delete t.password,delete t.repeatPassword,t.id=this.nowId,this.$.autoAjax("put",URL.api+ROUTES.PUT.sub.accounts,t,{ok:e=>{null!=e.data&&e.data?(s.$message.success(LANG["恭喜您，修改成功！"]||"恭喜您，修改成功！"),s.updated=!0):s.$message.error(LANG["修改失败！"]||"修改失败！"),s.loading=!1,s.updated=!0},p:()=>{},error:e=>{console.log(e)}}))},doHandle(e){switch(this.nowId=parseInt(e.row.id)||-1,this.updated=!1,this.formType="",e.fn){case"doEnable":this.doStart(e.row);break;case"doDisable":this.doStop(e.row);break;case"doUpdatePass":this.doUpdatePass(e.row);break;case"doDelete":this.doDelete(e.row);break;case"doUnbind":this.doUnbind(e.row);break;case"doEdit":this.doEdit(e.row)}},doStart(e){this.nowName=e.username,parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定启用"]||"确定启用")+'"'+e.username+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="start")},doStop(e){this.nowName=e.username,parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定停用"]||"确定停用")+'"'+e.username+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="stop")},doDelete(e){parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定删除"]||"确定删除")+'"'+e.username+'"'+(this.LANG["吗？"]||"吗？"),this.userName=e.username,this.confirmConfig.fn="delete")},doConfirm(e){this.loading=!0;let s=this;switch(e.fn){case"start":this.$.autoAjax("patch",URL.api+"/sub/accounts?id="+parseInt(s.nowId),{state:1,sub_name:s.nowName},{ok:e=>{null!=e.data&&e.data?(s.$message.success(LANG["恭喜您，子帐号启用成功！"]||"恭喜您，子帐号启用成功！"),s.updated=!0):s.$message.error(LANG["子帐号启用失败，请稍候重试！"]||"子帐号启用失败，请稍候重试！"),s.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"delete":this.$.autoAjax("delete",URL.api+"/sub/accounts?id="+parseInt(s.nowId)+"&sub_name="+s.userName,"",{ok:e=>{null!=e.data&&e.data?(s.$message.success(LANG["恭喜您，子帐号删除成功！"]||"恭喜您，子帐号删除成功！"),s.updated=!0):s.$message.error(LANG["子帐号删除失败，请稍候重试！"]||"子帐号删除失败，请稍候重试！"),s.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"stop":this.$.autoAjax("patch",URL.api+"/sub/accounts?id="+parseInt(s.nowId),{state:0,sub_name:s.nowName},{ok:e=>{null!=e.data&&e.data?(s.$message.success(LANG["恭喜您，子帐号停用成功！"]||"恭喜您，子帐号停用成功！"),s.updated=!0):s.$message.error(LANG["子帐号停用失败，请稍候重试！"]||"子帐号停用失败，请稍候重试！"),s.loading=!1},p:()=>{},error:e=>{console.log(e)}})}},doUpdatePass(e){this.formType="pass",this.isEdit.state=!0,this.passTitle=LANG["修改 "+e.username+" 密码"]||"修改 "+e.username+" 密码",this.userId=e.id,this.userName=e.username,this.passVisible.state=!0},doUnbind(e){let s={};this.updated=!1,s.uid=parseInt(e.id),s.role=2;let t=this;this.$.autoAjax("post",URL.api+ROUTES.POST.admin.login.unbind,s,{ok:e=>{0===e.state&&e.data?(t.updated=!0,t.$message.success(LANG["恭喜您，解绑成功！"]||"恭喜您，解绑成功！")):t.$message.error(LANG["解绑失败，请稍后重试！"]||"解绑失败，请稍后重试！")},p:()=>{},error:e=>{console.log(e)}}).catch(e=>{t.$message.error(LANG["未知错误，请稍后重试！"]||"未知错误，请稍后重试！")})}},computed:{},mounted(){},created(){this.init()}},l=t(10);var d=function(e){t(499)},n=Object(l.a)(r,function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"clearfix",attrs:{id:"childAccount"}},[t("formEdit",{attrs:{formVisible:e.searchFormVisible,formConfig:e.searchConfig,type:e.searchType,labelWidth:e.labelWidth,isEdit:e.searchIsEdit,showAdd:!1},on:{"do-query":e.doQuery,"reset-form":e.resetForm}}),e._v(" "),t("el-col",[t("el-button",{staticClass:"addManage",attrs:{type:"primary",size:"small"},domProps:{textContent:e._s(e.LANG["新增管理员"]||"新增管理员")},on:{click:e.doAdd}})],1),e._v(" "),t("el-col",[t("tablegrid",{attrs:{columnsUrl:e.columnsUrl,tableUrl:e.tableUrl,tableCheck:!1,showRefresh:!1,updated:e.updated},on:{"do-handle":e.doHandle}})],1),e._v(" "),t("el-col",{staticClass:"addWindow"},[t("formEdit",{attrs:{formTitel:e.formTitel,formVisible:e.formVisible,formConfig:e.formConfig,type:e.type,labelWidth:e.labelWidth,isEdit:e.isEdit,updateKeys:e.updateKeys,formType:e.formType},on:{"get-form":e.getForm}})],1),e._v(" "),t("el-col",[t("formEdit",{attrs:{formTitel:e.passTitle,formVisible:e.passVisible,formConfig:e.passConfig,type:e.type,labelWidth:e.labelWidth,isEdit:e.isEdit},on:{"get-form":e.getForm}})],1),e._v(" "),t("el-col",[t("confirm",{attrs:{confirmConfig:e.confirmConfig},on:{"do-confirm":e.doConfirm}})],1)],1)},[],!1,d,null,null);s.default=n.exports},499:function(e,s,t){}}]);