(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{197:function(e,t,a){"use strict";a.r(t);var s=a(265),i=a(10);var o=function(e){a(510)},l=Object(i.a)(s.a,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"clearfix",attrs:{id:"receivableBank"}},[a("formEdit",{attrs:{formVisible:e.formVisible,formConfig:e.searchConfig,type:"search",labelWidth:e.labelWidth,isEdit:e.isEdit,size:e.size,addText:e.LANG["新增账户"]||"新增账户"},on:{"do-query":e.doQuery,"reset-form":e.resetForm,"add-new":e.AddNew}}),e._v(" "),e.fullscreenLoading?e._e():a("div",{staticClass:"search"}),e._v(" "),e.fullscreenLoading?e._e():a("el-col",[a("tablegrid",{ref:"bankTable",staticClass:"bankTable",attrs:{columnsUrl:e.columnsUrl,tableUrl:e.tableUrl,tableCheck:!1,isCreated:!0,updated:e.updated},on:{"do-handle":e.doHandle}})],1),e._v(" "),a("el-col",[a("formEdit",{attrs:{formTitel:e.formTitel,formVisible:e.editVisible,formConfig:e.formConfig,type:e.type,size:e.size,labelWidth:e.labelWidth,isEdit:e.isEdit,formType:e.formType},on:{"get-form":e.getForm}})],1),e._v(" "),a("el-col",[a("confirm",{attrs:{confirmConfig:e.confirmConfig},on:{"do-confirm":e.doConfirm}})],1)],1)},[],!1,o,null,null);t.default=l.exports},265:function(e,t,a){"use strict";(function(e){var s=a(202),i=a(203),o=a(206);t.a={data:()=>({updated:!1,confirmConfig:{state:!1,msg:"",fn:"",obj:null},formVisible:{state:!1},LANG:LANG,tableUrl:"",baseUrl:"",columnsUrl:"",nowId:-1,formType:"default",page:1,searchConfig:[{prop:"name",value:"",type:"text",label:"户名"},{prop:"bank_id",value:"",label:"银行名称",type:"select",list:[]},{prop:"level",value:"",type:"select",list:ARRAYS.LEVELSLIST,label:"会员等级"},{prop:"status",value:"",label:"状态",type:"select",list:[{label:"启用",value:"enabled"},{label:"停用",value:"disabled"}]}],updateType:"",size:"small",formConfig:[{prop:"levels",value:[],label:"开放会员等级",sReset:!1,checkAll:!1,allBtnShow:!0,type:"checkGroup",list:[],Arr:ARRAYS.LEVELSLIST,rules:[{require:!0}]},{prop:"bank_id",value:"",label:"银行名称/支付名称",type:"select",list:[],rules:[{require:!0}]},{prop:"accountname",value:"",type:"text",label:"户名",rules:[{require:!0}]},{prop:"address",value:"",type:"text",label:"开户行",rules:[{require:!0}]},{prop:"card",value:"",type:"text",label:"帐号",rules:[{require:!0},{max:60}]},{prop:"qrcode",value:[],type:"upload",label:"二维码地址",action:URL.img,fileNum:1},{prop:"limit_day_max",value:"",type:"number",label:"日停用金额",rules:[{varMax:1e7},{require:!0}]},{prop:"sort",value:"",type:"number",label:"排序",rules:[{require:!0}]},{prop:"is_enabled",value:"1",label:"状态",type:"select",list:[{label:"启用",value:"1"},{label:"停用",value:"0"}],isDefault:!0},{prop:"comment",value:"",type:"textarea",label:"存款说明",rules:[{require:!0}]}],type:"default",formType:"",formTitel:"",labelWidth:"120px",editVisible:{state:!1},isEdit:{state:!1},nowId:-1,fullscreenLoading:!1,loading:!1}),components:{tablegrid:s.a,formEdit:i.a,confirm:o.a},methods:{init(){let t=this;this.fullscreenLoading=!0,this.tableUrl=URL.api+ROUTES.GET.cash.bank.acounts,this.baseUrl=URL.api+ROUTES.GET.cash.bank.acounts,this.columnsUrl="/static/json/cash/receivableBank/columns.json",this.$.autoAjax("get",URL.api+ROUTES.GET.allBanks,"",{ok:e=>{if(0==e.state&&e.data.length){let a=e.data||[],s=t.formConfig[1].list,i=t.searchConfig[1].list;if(a.length>0)for(let e in a)s.push({label:a[e].name,value:a[e].id}),i.push({label:a[e].name,value:a[e].id});t.fullscreenLoading=!1}},p:()=>{},error:e=>{console.log(e)}});let a=e.ARRAYS.LEVELSLIST;for(let e in a)t.formConfig[0].list.push(a[e].value)},AddNew(){this.formTitel="新增收款银行账户",this.formConfig[8].disabled=!1,this.editVisible.state=!0,this.formType="add"},getForm(e){let t=this;this.fullscreenLoading=!0,t.updated=!1,parseInt(e.formObj.limit_day_max)>0&&(e.formObj.limit_day_max=100*e.formObj.limit_day_max),parseInt(e.formObj.limit_max)>0&&(e.formObj.limit_max=100*e.formObj.limit_max),""==e.formObj.qrcode?e.formObj.qrcode=null:e.formObj.qrcode=e.formObj.qrcode.toString(),e.formObj.levels=e.formObj.levels.join(",");let a={};for(let t in e.formObj)a[t]=e.formObj[t];a.accountname=e.formObj.accountname,a.sort||(a.sort=0),"edit"==this.formType&&(delete a.id,this.$.autoAjax("put",URL.api+ROUTES.PUT.cash.bank.account+"?id="+this.nowId,a,{ok:e=>{0==e.state&&e.data?t.$message.success(LANG["修改收款账户成功"]||"修改收款账户成功"):2003==e.state&&e.data?t.$message.error(LANG["无修改权限!"]||"无修改权限!"):1002==e.state&&e.data?t.$message.error(LANG["相同的银行账号已经存在!"]||"相同的银行账号已经存在!"):t.$message.error(LANG[e.msg]||e.msg),t.updated=!0},p:()=>{},error:e=>{}})),"add"==this.formType&&this.$.autoAjax("put",URL.api+ROUTES.POST.cash.bank.account,a,{ok:e=>{0==e.state&&e.data?t.$message.success(LANG["新增收款账户成功"]||"新增收款账户成功"):1002==e.state&&e.data?t.$message.error(LANG["相同的银行账号已经存在!"]||"相同的银行账号已经存在!"):t.$message.error(LANG[e.msg]||e.msg),t.updated=!0},p:()=>{},error:e=>{console.log(e)}}),this.fullscreenLoading=!1,t.formType=""},doHandle(e){switch(this.nowId=parseInt(e.row.id)||-1,this.formType="",this.updated=!1,e.fn){case"doEdit":this.doEdit(e.row);break;case"doDisable":this.doDisable(e.row);break;case"doEnable":this.doEnable(e.row);break;case"doDelete":this.doDelete(e.row)}},doDisable(e){parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定停用"]||"确定停用")+'"'+e.accountname+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="disabled",this.confirmConfig.obj=e)},doDelete(e){parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定删除"]||"确定删除")+'"'+e.accountname+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="doDelete",this.confirmConfig.obj=e)},doEnable(e){parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定启用"]||"确定启用")+'"'+e.accountname+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="enabled",this.confirmConfig.obj=e)},doConfirm(e){this.loading=!0;let t=this;switch(e.fn){case"disabled":this.$.autoAjax("patch",URL.api+ROUTES.PATCH.cash.bank.account+"?id="+t.nowId,{status:0},{ok:e=>{0==e.state&&e.data?(t.formType="disabled",t.$message.success(t.LANG["收款银行帐号停用成功！"]||"收款银行帐号停用成功！"),t.updated=!0):4003==e.state||405==e.state?t.$message.error(e.msg+(t.LANG["权限不足！"]||"权限不足！")):t.$message.error(t.LANG["收款银行帐号停用失败，请稍后重试！"]||"收款银行帐号停用失败，请稍后重试！"),t.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"enabled":this.$.autoAjax("patch",URL.api+ROUTES.PATCH.cash.bank.account+"?id="+t.nowId,{status:1},{ok:e=>{0==e.state&&e.data?(t.formType="enabled",t.$message.success(t.LANG["收款银行帐号启用成功！"]||"收款银行帐号启用成功！"),t.updated=!0):4003==e.state||405==e.state?t.$message.error(e.msg+(t.LANG["权限不足！"]||"权限不足！")):t.$message.error(e.msg),t.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"doDelete":this.$.autoAjax("delete",URL.api+ROUTES.DELETE.cash.bank.account+"?id="+t.nowId,"",{ok:e=>{0==e.state&&e.data?(t.formType="doDelete",t.$message.success(t.LANG["收款银行帐号删除成功！"]||"收款银行帐号删除成功！"),t.updated=!0):4003==e.state||405==e.state?t.$message.error(e.msg+(t.LANG["权限不足！"]||"权限不足！")):t.$message.error(t.LANG["收款银行帐号删除失败，请稍后重试！"]||"收款银行帐号删除失败，请稍后重试！"),t.loading=!1},p:()=>{},error:e=>{console.log(e)}})}},doEdit(e){let t=this,a=[];this.loading=!0,this.formTitel="编辑收款银行账户",this.nowId=parseInt(e.id),this.isEdit.state=!1,this.formConfig[8].disabled=!0,this.$.autoAjax("get",URL.api+ROUTES.GET.cash.bank.acount+"?id="+this.nowId,"",{ok:e=>{if(0==e.state&&e.data){let s=e.data?e.data:{};s.levels.length&&(s.levels.toUpperCase().split(",").forEach((e,t)=>{a[t]=e.split("VIP")[1]}),s.levels=a),FORMATNUMBER(s.limit_day_max)>0&&(s.limit_day_max=FORMATMONEY(s.limit_day_max).toString()),FORMATNUMBER(s.limit_max)>0&&(s.limit_max=FORMATMONEY(s.limit_max).toString()),FORMVAL(s,t.formConfig),t.formConfig[0].value=s.levels,t.formType="edit",t.editVisible.state=!0,t.isEdit.state=!0}else t.$message.error(t.LANG["获取收款银行信息失败，请稍后重试！"]||"获取收款银行信息失败，请稍后重试！")},p:()=>{},error:e=>{console.log(e)}}),t.loading=!1},doQuery(e){this.tableUrl=this.baseUrl+this.addSearch(e.item)},resetForm(){this.tableUrl=this.baseUrl}},computed:{},mounted(){},created(){this.init()},activated(){this.updated=!1,setTimeout(()=>{this.updated=!0},500)}}}).call(this,a(4))},510:function(e,t,a){}}]);