(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{141:function(e,t,a){"use strict";a.r(t);var i=a(202),s=a(203),o=a(206),l={data:()=>({LANG:LANG,columnsUrl:"",tableUrl:"",baseUrl:"",dialogVisible:!1,searchConfig:[{prop:"name",value:"",type:"text",label:"优惠活动名称"},{prop:"issue_mode",value:"",label:"发放方式",type:"select",list:[{label:"手动",value:"manual"},{label:"自动",value:"auto"}]},{prop:"status",value:"",label:"状态",type:"select",list:[{label:"启用",value:"enabled"},{label:"停用",value:"disabled"}]},{type:"dateGroup",label:"创建时间",prop:[{prop:"begin_time",value:"",label:"开始时间"},{prop:"end_time",value:"",label:"结束时间"}]}],typeSearch:"search",labelWidthSearch:"100px",formVisibleSearch:{state:!1},isEditSearch:{state:!1},formConfig:[{prop:"name",value:"",type:"text",label:"优惠活动名称",rules:[{require:!0}]},{prop:"type_id",value:"",label:"所属优惠类型",type:"select",list:[],rules:[{require:!0}]},{prop:"created_uname",value:"",type:"text",label:"创建人",rules:[{require:!0}]},{type:"dateGroup",label:"建立时间",prop:[{prop:"begin_time",value:"2014",label:"开始时间",type:"datePicker"},{prop:"end_time",value:"",label:"结束时间",type:"datePicker"}]}],type:"default",formTitel:"",labelWidth:"110px",editVisible:{state:!1},isEdit:{state:!1},confirmConfig:{state:!1},labelform:{id:"",name:"",type_name:"",created_uname:"",begin_time:"",end_time:""},nowId:"",updated:!1,formType:"",loading:!1,modeType:0,modeName:""}),components:{tablegrid:i.a,formEdit:s.a,confirm:o.a},methods:{init(){this.columnsUrl="static/json/preAct/activeSet/columns.json",this.tableUrl=URL.api+ROUTES.GET.actives.$,this.baseUrl=URL.api+ROUTES.GET.actives.$;let e=this.formConfig[1].list;this.$.autoAjax("get",URL.api+ROUTES.GET.activity.types+"?page=1&page_size=100","",{ok:t=>{if(0==t.state&&t.data){let a=t.data||[];for(let t in a)e.push({label:a[t].name,value:a[t].id.toString()})}},p:()=>{},error:e=>{console.log(e)}})},doAddNews(){this.$router.push({path:"/addActiveSet"})},doQuery(e){this.tableUrl=this.baseUrl+this.addSearch(e.item)},resetForm(e){this.tableUrl=this.baseUrl},doHandle(e){switch(this.formType="",e.fn){case"doStop":this.doStop(e.row);break;case"doStart":this.doStart(e.row);break;case"domodification":this.domodification(e.row);break;case"doDel":this.doDel(e.row)}},doStop(e){this.nowId=e.id,parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定停用"]||"确定停用")+'"'+e.name+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="stop")},doStart(e){this.nowId=e.id,parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定启用"]||"确定启用")+'"'+e.name+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="start")},doConfirm(e){this.loading=!0,this.updated=!1;let t=this;switch(e.fn){case"stop":let a=URL.api+ROUTES.PATCH.active.manualStatus+"/"+this.nowId;this.$.autoAjax("patch",a,{status:"disabled"},{ok:e=>{if(0==e.state&&e.data)t.$message.success(LANG["恭喜您，停用成功！"]||"恭喜您，停用成功！"),t.updated=!0;else{let a=LANG[`${e.msg}`]||`${e.msg}`;t.$message.error(a)}t.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"start":let i=URL.api+ROUTES.PATCH.active.manualStatus+"/"+this.nowId;this.$.autoAjax("patch",i,{status:"enabled"},{ok:e=>{if(0==e.state&&e.data)t.$message.success(LANG["恭喜您，启用成功！"]||"恭喜您，启用成功！"),t.updated=!0;else{let a=LANG[`${e.msg}`]||`${e.msg}`;t.$message.error(a)}t.loading=!1},p:()=>{},error:e=>{console.log(e)}});break;case"delete":let s=URL.api+ROUTES.DELETE.active.manualDel+"/"+this.nowId+"?type="+t.modeType+"&name="+t.modeName;this.$.autoAjax("delete",s,"",{ok:e=>{0==e.state&&e.data?(t.$message.success(LANG["恭喜您，删除成功！"]||"恭喜您，删除成功！"),t.updated=!0):(t.$message.error(LANG["删除失败，请稍后重试！"]||"删除失败，请稍后重试！"),t.updated=!1),t.loading=!1},p:()=>{},error:e=>{console.log(e)}})}},domodification(e){this.nowId=e.id,this.$router.push({path:`activeMode_${e.template_id}`,query:{label:e.name,id:e.id,template_id:e.template_id,status:e.status,type:"edit"}})},doDel(e){this.modeName=e.name,this.nowId=e.id,parseInt(e.id)&&(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定删除"]||"确定删除")+'"'+e.name+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="delete")}},computed:{},mounted(){},created:function(){this.init()}},r=a(10);var d=function(e){a(430)},n=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"clearfix",attrs:{id:"activeSet"}},[a("el-col",[a("formEdit",{attrs:{formVisible:e.formVisibleSearch,formConfig:e.searchConfig,type:e.typeSearch,initDate:!0,labelWidth:e.labelWidthSearch,isEdit:e.isEditSearch,showAdd:!1},on:{"do-query":e.doQuery,"reset-form":e.resetForm}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},domProps:{textContent:e._s(e.LANG["新增优惠活动"]||"新增优惠活动")},on:{click:e.doAddNews}})],1),e._v(" "),a("el-col",{staticClass:"mt10"},[a("tablegrid",{attrs:{columnsUrl:e.columnsUrl,tableUrl:e.tableUrl,tableCheck:!1,pageSet:!0,updated:e.updated,showRefresh:!1,tableIndex:!1},on:{"do-handle":e.doHandle}})],1),e._v(" "),a("el-col",[a("formEdit",{staticClass:"formWindow",attrs:{formTitel:e.formTitel,formVisible:e.editVisible,formConfig:e.formConfig,type:e.type,labelWidth:e.labelWidth,isEdit:e.isEdit,formType:e.formType}})],1),e._v(" "),a("el-col",[a("confirm",{attrs:{confirmConfig:e.confirmConfig},on:{"do-confirm":e.doConfirm}})],1)],1)},[],!1,d,"data-v-2c7a40e0",null);t.default=n.exports},430:function(e,t,a){}}]);