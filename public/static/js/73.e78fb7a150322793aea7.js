(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{162:function(e,t,s){"use strict";s.r(t);var o=s(197),i=s(198),a=s(201),l={data:()=>({LANG:LANG,tableUrl:"",columnsUrl:"",states:ARRAYS.state1,formType:"",type:"default",formTitel:"",labelWidth:"90px",editVisible:{state:!1},isEdit:{state:!1},formConfig:[{prop:"t_name",value:"",type:"text",label:"模板名称",rules:[{require:!0}]},{prop:"t_desc",value:"",type:"textarea",label:"模板描述"},{prop:"t_status",value:"0",label:"状态",type:"select",list:ARRAYS.state1,rules:[{require:!0}]}],copyAdd:!1,nowId:-1,confirmConfig:{state:!1,msg:"",fn:"",obj:{},btnShow:!1},updated:!1,loading:!1,dialogMode:!1,columnsMember:"",tableMember:"",tabOperation:[{label:"批量解除关联",fn:"UnbundMembeer"}],modelTitle:"",dialogModeLevel:!1,LevelTitle:"",columnsLevel:"",tableLevel:"",tabOperationLevel:[{label:"批量解除关联",fn:"UnbundLevel"}]}),components:{tablegrid:o.a,formEdit:i.a,confirm:a.a},methods:{init(){this.tableUrl=URL.api+ROUTES.GET.lottery.template,this.columnsUrl="static/json/lotteryNew/lotterytemplate/columns.json",this.dialogMode=!1},getForm(e){this.loading=!0;let t=this;if("edit"==this.formType&&(e.formObj.id=this.nowId),"copyAdd"==this.formType){let s={};s.id=this.nowId,s.name=e.formObj.t_name,s.desc=e.formObj.t_desc,s.status=e.formObj.t_status,this.$.autoAjax("put",URL.api+"/lottery/template.copy",s,{ok:e=>{0===e.state&&e.data?(t.$message.success(LANG["恭喜您，彩票模板复制成功！"]||"恭喜您，彩票模板复制成功！"),t.loading=!1,t.updated=!0):(t.$message.success(LANG["彩票模板复制失败，请稍后重试！"]||"彩票模板复制失败，请稍后重试！"),t.loading=!1)},p:()=>{},error:e=>{console.log(e)}})}else this.$.autoAjax("put",URL.api+ROUTES.PUT.lottery.template,e.formObj,{ok:e=>{0==e.state&&e.data?("add"==t.formType?t.$message.success(LANG["恭喜您，彩票模板添加成功！"]||"恭喜您，彩票模板添加成功！"):t.$message.success(LANG["恭喜您，彩票模板修改成功！"]||"恭喜您，彩票模板修改成功！"),t.updated=!0):("add"==t.formType?str=LANG["新增彩票模板失败，请稍候重试！"]||"新增彩票模板失败，请稍候重试！":str=LANG["修改彩票模板失败，请稍候重试！"]||"修改彩票模板失败，请稍候重试！",t.$message.error(str)),this.loading=!1},p:()=>{},error:e=>{console.log(e)}})},doHandle(e){switch(this.formType="",this.copyShow=!1,this.nowId=parseInt(e.row.t_id)||-1,this.updated=!1,e.fn){case"doCopyAdd":this.doCopyAdd(e.row);break;case"doEdit":this.doEdit(e.row);break;case"doSetOdds":this.doSetOdds(e.row);break;case"doDelDate":this.doDelDate(e.row);break;case"doEnable":this.doEnable(e.row);break;case"doDisable":this.doDisable(e.row);break;case"setMember":this.setMember(e.row);break;case"setLevlLimit":this.setLevlLimit(e.row)}},UnbundMembeer(e){let t=[];for(let s=0;s<e.length;s++)t.push(e[s].user_id);let s={user_id:t};this.loading=!0,this.updated=!1;let o=this;this.$.autoAjax("post",URL.api+"/lottery/template.users",s,{ok:e=>{0==e.state&&e.data?(o.$message.success(LANG["恭喜您，会员解除关联成功！"]||"恭喜您，会员解除关联成功！"),o.updated=!0):e.msg?o.$message.error(e.msg):o.$message.error(LANG["会员解除关联失败，请稍候重试！"]||"会员解除关联失败，请稍候重试！"),o.loading=!1,o.dialogMode=!1,o.updated=!0},p:()=>{},error:e=>{console.log(e)}})},UnbundLevel(e){let t=[];for(let s=0;s<e.length;s++)t.push(e[s].level_id);let s={level_id:t};this.loading=!0,this.updated=!1;let o=this;this.$.autoAjax("post",URL.api+"/lottery/template.levels/",s,{ok:e=>{0==e.state&&e.data?(o.$message.success(LANG["恭喜您，层级解除关联成功！"]||"恭喜您，层级解除关联成功！"),o.updated=!0):e.msg?o.$message.error(e.msg):o.$message.error(LANG["层级解除关联失败，请稍候重试！"]||"层级解除关联失败，请稍候重试！"),o.loading=!1,o.dialogModeLevel=!1,o.updated=!0},p:()=>{},error:e=>{console.log(e)}})},doOperation(e){switch(e.fn){case"UnbundMembeer":this.UnbundMembeer(e.rows)}},doOperationLevel(e){switch(e.fn){case"UnbundLevel":this.UnbundLevel(e.rows)}},setMember(e){this.modelTitle=e.t_name,this.tableMember="",0==e.member_number?(this.$message.error(LANG["该模板无会员可解绑"]||"该模板无会员可解绑"),this.dialogMode=!1):(this.dialogMode=!0,setTimeout(()=>{this.columnsMember="static/json/lotteryNew/lotterytemplate/columnsMember.json",this.tableMember=URL.api+"/lottery/template.users?tid="+e.t_id},300))},setLevlLimit(e){this.LevelTitle=e.t_name,this.tableLevel="",0==e.level_number?(this.$message.error(LANG["该模板无层级可解绑"]||"该模板无层级可解绑"),this.dialogModeLevel=!1):(this.dialogModeLevel=!0,setTimeout(()=>{this.columnsLevel="static/json/lotteryNew/lotterytemplate/columnsLevel.json",this.tableLevel=URL.api+"/lottery/template.levels?tid="+e.t_id},300))},doCopyAdd(e){this.loading=!0,this.formType="",FORMVAL(e,this.formConfig),this.copyAdd=!0;let t=this;setTimeout(function(){t.formTitel=this.LANG["复制新增彩票模板"]||"复制新增彩票模板",t.editVisible.state=!0,t.formType="copyAdd",t.loading=!1},500)},doDelDate(e){let t=e.t_name;"1"===e.t_status?this.$message.error(LANG["启用的模板不可删除，请停用后重试！"]||"启用的模板不可删除，请停用后重试！"):FORMATNUMBER(e.member_number)>0||e.level_number>0?this.$message.error(LANG["此模板关联了会员和层级，不可以删除，请把关联的会员、层级全部解除"]||"此模板关联了会员和层级，不可以删除，请把关联的会员、层级全部解除"):(this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定删除"]||"确定删除")+'"'+t+'"'+(this.LANG["吗？"]||"吗？"),this.confirmConfig.fn="delete")},doConfirm(e){this.loading=!0;let t=this,s={};switch(e.obj&&(s=e.obj),s.id=parseInt(this.nowId),e.fn){case"delete":this.$.autoAjax("delete",URL.api+ROUTES.DELETE.lottery.template.$(parseInt(this.nowId)),"",{ok:e=>{0==e.state&&e.data?(t.$message.success(LANG["恭喜您，彩票模板删除成功！"]||"恭喜您，彩票模板删除成功！"),t.updated=!0):t.$message.error(LANG["彩票模板删除失败，请稍候重试！"]||"彩票模板删除失败，请稍候重试！"),t.loading=!1},p:()=>{},error:e=>{t.$message.error(LANG["彩票模板删除失败，请稍候重试！"]||"彩票模板删除失败，请稍候重试！"),t.loading=!1}});break;case"enable":this.$.autoAjax("put",URL.api+ROUTES.PUT.lottery.template,{t_status:1,id:this.nowId,t_name:s.t_name,t_desc:s.t_desc},{ok:e=>{0==e.state&&e.data?(t.$message.success(LANG["恭喜您，彩票模板启用成功！"]||"恭喜您，彩票模板启用成功！"),t.updated=!0):t.$message.error(LANG["彩票模板启用失败，请稍候重试！"]||"彩票模板启用失败，请稍候重试！"),t.loading=!1},p:()=>{},error:e=>{t.$message.error(LANG["彩票模板启用失败，请稍候重试！"]||"彩票模板启用失败，请稍候重试！"),t.loading=!1}});break;case"disable":this.$.autoAjax("put",URL.api+ROUTES.PUT.lottery.template,{t_status:0,id:this.nowId,t_name:s.t_name,t_desc:s.t_desc},{ok:e=>{0==e.state&&e.data?(t.$message.success(LANG["恭喜您，彩票模板停用成功！"]||"恭喜您，彩票模板停用成功！"),t.updated=!0):t.$message.error(LANG["彩票模板停用失败，请稍候重试！"]||"彩票模板停用失败，请稍候重试！"),t.loading=!1},p:()=>{},error:e=>{t.$message.error(LANG["彩票模板停用失败，请稍候重试！"]||"彩票模板停用失败，请稍候重试！"),t.loading=!1}})}},doSetOdds(e){this.$router.push({path:"/lotteryOdds",query:{id:parseInt(this.nowId),name:e.t_name}})},doEnable(e){this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定要启用"]||"确定要启用")+'"'+e.t_name+'"'+(this.LANG["这个模板吗?当前网站模板将停止使用."]||"这个模板吗?当前网站模板将停止使用."),this.confirmConfig.fn="enable",this.confirmConfig.obj=e},doDisable(e){this.confirmConfig.state=!0,this.confirmConfig.msg=(this.LANG["确定要停用"]||"确定要停用")+'"'+e.t_name+'"'+(this.LANG["这个模板吗?"]||"这个模板吗?"),this.confirmConfig.fn="disable",this.confirmConfig.obj=e},doEdit(e){this.loading=!0,FORMVAL(e,this.formConfig),this.formTitel=this.LANG["修改彩票模板"]||"修改彩票模板";let t=this;setTimeout(function(){t.formType="edit",t.editVisible.state=!0,t.loading=!1},500)},doAdd(){this.updated=!1,this.formTitel="新增彩票模板",this.editVisible.state=!0,this.formType="add"}},created(){this.init()}},r=s(24);var d=function(e){s(455)},n=Object(r.a)(l,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"templateManage clearfix",attrs:{id:"cs"}},[s("el-col",{staticClass:"addManage",attrs:{span:24}},[s("el-button",{attrs:{type:"primary",size:"small"},domProps:{textContent:e._s(e.LANG["新增彩票游戏模板"]||"新增彩票游戏模板")},on:{click:e.doAdd}})],1),e._v(" "),s("el-col",{staticClass:"mt10",attrs:{span:24}},[s("formEdit",{attrs:{formTitel:e.formTitel,formVisible:e.editVisible,formConfig:e.formConfig,type:e.type,labelWidth:e.labelWidth,isEdit:e.isEdit,formType:e.formType},on:{"get-form":e.getForm}})],1),e._v(" "),s("el-col",{attrs:{span:24}},[s("tablegrid",{attrs:{columnsUrl:e.columnsUrl,tableUrl:e.tableUrl,updated:e.updated,showRefresh:!1},on:{"do-handle":e.doHandle}})],1),e._v(" "),s("el-col",[s("confirm",{attrs:{confirmConfig:e.confirmConfig},on:{"do-confirm":e.doConfirm}})],1),e._v(" "),s("el-dialog",{attrs:{title:e.LANG["会员层级"]||"会员层级",visible:e.dialogMode,size:"tiny"},on:{"update:visible":function(t){e.dialogMode=t}}},[s("span",[s("div",{staticClass:"mb10"},[e._v("\n                "+e._s(e.LANG["限额模板名称"]||"限额模板名称")+" ( "+e._s(e.modelTitle)+" )\n            ")]),e._v(" "),s("div",{staticClass:"dialogModeBox"},[s("tablegrid",{attrs:{columnsUrl:e.columnsMember,tableUrl:e.tableMember,isCreated:!0,tableCheck:!0,tabOperation:e.tabOperation,showRefresh:!1},on:{"do-operation":e.doOperation}})],1)])]),e._v(" "),s("el-dialog",{attrs:{title:e.LANG["会员层级"]||"会员层级",visible:e.dialogModeLevel,size:"tiny"},on:{"update:visible":function(t){e.dialogModeLevel=t}}},[s("span",[s("div",{staticClass:"mb10"},[e._v("\n                "+e._s(e.LANG["限额模板名称"]||"限额模板名称")+" ( "+e._s(e.LevelTitle)+" )--\n            ")]),e._v(" "),s("div",{staticClass:"dialogModeBox"},[s("tablegrid",{attrs:{columnsUrl:e.columnsLevel,tableUrl:e.tableLevel,tableCheck:!0,tabOperation:e.tabOperationLevel,isCreated:!0,showRefresh:!1},on:{"do-operation":e.doOperationLevel}})],1)])])],1)},[],!1,d,null,null);t.default=n.exports},455:function(e,t,s){}}]);