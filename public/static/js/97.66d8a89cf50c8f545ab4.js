(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{163:function(t,e,s){"use strict";s.r(e);var i=s(202),a=s(203),o=s(15),l=s.n(o),r={data:()=>({LANG:LANG,columnsUrl:"",tableUrl:"",searchConfig:[{prop:"ip",value:"",type:"text",label:"IP"},{prop:"status",value:"",label:"状态",type:"select",list:[{label:"允许",value:"0"},{label:"禁止",value:"1"}]}],nowId:-1,isEdit:{},labelWidth:"80px",baseUrl:"",formVisible:{state:!1},type:"default",formTitle:"",formType:"",formLabelWidth:"60px",formConfig:[{prop:"ip",value:"",label:"IP",type:"textarea",rows:"1",placeholder:"提示:多个ip请用英文的 / 隔开",rules:[{require:!0}]},{prop:"memo",value:"",label:"备注",type:"textarea",rules:[{max:128}]},{prop:"status",value:"",label:"状态",type:"select",rules:[{require:!0}],list:[{label:"允许",value:"0"},{label:"禁止",value:"1"}]}],selectedIds:[],tabOperation:[{label:"批量删除",fn:"doBatchDel"},{label:"批量限制",fn:"doBatchLimit"},{label:"批量允许",fn:"doBatchAllow"}],updated:!1}),components:{tablegrid:i.a,formEdit:a.a},methods:{init(){this.columnsUrl="/static/json/systemSettings/IPblacklist/columns.json",this.tableUrl=URL.api+ROUTES.GET.system.ipblacks,this.baseUrl=URL.api+ROUTES.GET.system.ipblacks},doQuery(t){this.tableUrl=this.baseUrl+this.addSearch(t.item)},resetForm(){this.tableUrl=this.baseUrl+"?time_begin="+sessionStorage.dateTimeStart+"&time_end="+sessionStorage.dateTimeEnd},doOperation(t){switch(t.fn){case"doBatchDel":this.doBatchDel(t.rows);break;case"doBatchAllow":this.doBatchAllow(t.rows);break;case"doBatchLimit":this.doBatchLimit(t.rows)}},doHandle(t){switch(this.formType="",t.fn){case"doEdit":this.doEdit(t.row);break;case"doAllow":this.submitAllow(t.row);break;case"doLimit":this.submitLimit(t.row);break;case"doDel":this.submitDel(t.row)}},doEdit(t){this.nowId=t.id,this.formTitle=this.LANG["修改IP"]||"修改IP",FORMVAL(t,this.formConfig);let e=this;setTimeout(function(){e.formVisible.state=!0,e.formType="edit"},500)},submitAllow(t){this.updated=!1;let e=[];e.push(t.id),this.$.autoAjax("patch",URL.api+"/system/ipblacks",{status:0,ids:e},{ok:t=>{0===t.state&&t.data?(this.$message.success(this.LANG["允许IP成功"]||"允许IP成功"),this.updated=!0):this.$message.error(this.LANG["允许IP失败，请稍后重试"]||"允许IP失败，请稍后重试")},p:()=>{},error:t=>{console.log(t)}})},submitLimit(t){this.updated=!1;let e=[];e.push(t.id),this.$.autoAjax("patch",URL.api+"/system/ipblacks",{status:1,ids:e},{ok:t=>{0===t.state&&t.data?(this.$message.success(this.LANG["限制IP成功"]||"限制IP成功"),this.updated=!0):this.$message.error(this.LANG["限制IP失败，请稍后重试"]||"限制IP失败，请稍后重试")},p:()=>{},error:t=>{console.log(t)}})},submitDel(t){this.updated=!1,this.$.autoAjax("delete",URL.api+ROUTES.DELETE.system.ipblacks+"?ids="+t.id,"",{ok:t=>{0===t.state&&t.data?(this.updated=!0,this.$message.success(this.LANG["删除IP成功"]||"删除IP成功")):this.$message.error(this.LANG["删除IP失败，请稍后重试"]||"删除IP失败，请稍后重试")},p:()=>{},error:t=>{console.log(t)}})},doDelete(t){let e=URL.api+ROUTES.DELETE.unused.list;this.$http.get(e).then(function(t){l.a.done()}).catch(function(t){})},doAddIP(){this.formTitle=this.LANG["添加IP"]||"添加IP",this.formVisible.state=!0,this.formType="add",this.isEdit.state=!1},doBatchDel(t){this.updated=!1;let e=this,s=[];for(let e in t)s.push(t[e].id);this.$.autoAjax("delete",URL.api+ROUTES.DELETE.system.ipblacks+"?ids="+s.join(","),"",{ok:t=>{0===t.state&&t.data?(e.$message.success(this.LANG["批量删除IP成功"]||"批量删除IP成功"),e.updated=!0):(e.$message.error(this.LANG["批量删除IP失败，请稍后重试"]||"批量删除IP失败，请稍后重试"),e.updated=!1)},p:()=>{},error:t=>{console.log(t)}})},doBatchAllow(t){this.updated=!1;let e=this,s=[];for(let e in t)s.push(t[e].id);this.$.autoAjax("patch",URL.api+ROUTES.PATCH.system.ipblacks,{status:0,ids:s},{ok:t=>{0===t.state&&t.data?(this.$message.success(this.LANG["批量允许IP成功"]||"批量允许IP成功"),e.updated=!0):(this.$message.error(this.LANG["批量允许IP失败，请稍后重试"]||"批量允许IP失败，请稍后重试"),e.updated=!1)},p:()=>{},error:t=>{console.log(t)}})},doBatchLimit(t){this.updated=!1;let e=this,s=[];for(let e in t)s.push(t[e].id);this.$.autoAjax("patch",URL.api+ROUTES.PATCH.system.ipblacks,{status:1,ids:s},{ok:t=>{0===t.state&&t.data?(this.$message.success(this.LANG["批量限制IP成功"]||"批量限制IP成功"),e.updated=!0):(this.$message.error(this.LANG["批量限制IP失败，请稍后重试"]||"批量限制IP失败，请稍后重试"),e.updated=!1)},p:()=>{},error:t=>{console.log(t)}})},submitForm(t){let e=this,s="";t.formObj.ip=t.formObj.ip.split("/");let i="";i="add"===this.formType?URL.api+ROUTES.PUT.system.ipblacks:URL.api+ROUTES.PUT.system.ipblacks+"?id="+parseInt(this.nowId),this.updated=!1,this.$.autoAjax("put",i,t.formObj,{ok:t=>{0===t.state&&t.data?("add"===e.formType?(s=e.LANG["新增IP成功！"]||"新增IP成功！",e.updateType="add"):(s=e.LANG["IP修改成功！"]||"IP修改成功！",e.updateType="edit"),e.$message.success(s),e.updated=!0):(s="add"===e.formType?t.data.msg:e.LANG["修改IP失败，请稍候重试！"]||"修改IP失败，请稍候重试！",e.$message.error(s)),e.formType="",e.formVisible.state=!1},p:()=>{},error:t=>{console.log(t)}})}},computed:{},mounted(){},created(){this.init()}},d=s(10);var p=function(t){s(474)},h=Object(d.a)(r,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"IpBlacklist"}},[s("el-col",{staticClass:"pb"},[s("formEdit",{attrs:{formVisible:t.formVisible,formConfig:t.searchConfig,type:"search",labelWidth:t.labelWidth,isEdit:{},addText:t.LANG["新增IP"]||"新增IP"},on:{"do-query":t.doQuery,"do-resetForm":t.resetForm,"add-new":t.doAddIP}})],1),t._v(" "),s("el-col",[s("tablegrid",{attrs:{columnsUrl:t.columnsUrl,tableUrl:t.tableUrl,tableCheck:!0,pageSet:!0,showRefresh:!1,tabOperation:t.tabOperation,updated:t.updated},on:{"do-operation":t.doOperation,"do-handle":t.doHandle}})],1),t._v(" "),s("el-col",[s("formEdit",{attrs:{formTitel:t.formTitle,formVisible:t.formVisible,formConfig:t.formConfig,type:t.type,labelWidth:t.formLabelWidth,formType:t.formType,isEdit:{}},on:{"get-form":t.submitForm}})],1)],1)},[],!1,p,null,null);e.default=h.exports},474:function(t,e,s){}}]);